#!/usr/bin/env node

var console = require("console");
var exec    = require("child_process").exec;

console.log("Starting build video.js");
exec("cd video.js && rm -rf node_modules && npm install && grunt dist", function(error, stdout, stderr){
  console.log("Finish build video.js");
  console.log(stderr);

  if (!error) {
    console.log("Starting build videojs-contrib-hls");
    exec("cd videojs-contrib-hls && rm -rf node_modules && npm install && npm run build", function(error, stdout, stderr){
      console.log("Finish build videojs-contrib-hls");
      console.log(stderr);

      if (!error) {
        console.log("Starting build videojs-contrib-ads");
        exec("cd videojs-contrib-ads && rm -rf node_modules && npm install && npm run prepublish", function(error, stdout, stderr){
          console.log("Finish build videojs-contrib-ads");
          console.log(stderr);

          if (!error) {
            console.log("Starting build videojs-ima");
            exec("cd videojs-ima && rm -rf node_modules && npm install", function(error, stdout, stderr){
              console.log("Finish build videojs-ima");
              console.log(stderr);

              if (!error) {
                console.log("Starting clean up");
                exec("rm -rf node_modules", function(){
                  console.log("Finish clean up");
                  console.log(stderr);
                });
              }
            });
          }
        });
      }
    });
  }
});
